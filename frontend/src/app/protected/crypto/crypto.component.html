<app-navbar />
<app-loading [loading]="loading"/>
<p-card header="Crypto" *ngIf="!loading">
    <p-dialog header="Modifica crypto" [modal]="true" [(visible)]="updateVisible" [style]="{ width: '50rem' }">
        <form [formGroup]="form" (ngSubmit)="updateCrypto(form.value, this.selectedCrypto?.simbolo)">
            <span class="p-text-secondary block mb-5">Modifica le informazioni.</span>
            <div class="field">
                <label for="simbolo" class="font-semibold w-6rem">Simbolo</label>
                <input pInputText id="simbolo" formControlName="simbolo" [value]="this.selectedCrypto?.simbolo"  autocomplete="off" />
            </div>
            <div class="field">
                <label for="nome" class="font-semibold w-6rem">Nome</label>
                <input pInputText id="nome" formControlName="nome" autocomplete="off" />
                <p-message *ngIf="form.controls.nome.invalid && form.controls.nome.dirty" severity="error" class="ml-2" text="Solo lettere." />
            </div>
            <div class="field">
                <label for="url" class="font-semibold w-6rem">Immagine</label>
                <input pInputText id="url" formControlName="url" autocomplete="off" />
                <p-message *ngIf="form.controls.url.invalid && form.controls.url.dirty" severity="error" class="ml-2" text="L'url deve essere valido." />
            </div>
            <div class="flex justify-content-end gap-2">
                <p-button label="Cancel" severity="secondary" (onClick)="updateVisible = false" />
                <p-button label="Save" type="submit"  [disabled]="!form.valid"/>
            </div>
        </form>
    </p-dialog>
    <p-table [value]="crypto" [paginator]="true" [rows]="5" styleClass="p-datatable-striped"
        [rowsPerPageOptions]="[5, 10, 20]" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
            <tr>
                <th>Image</th>
                <th>Simbolo</th>
                <th>Nome</th>
                <th>Modifica</th>
                <th>Elimina</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-crypto>
            <tr>
                <td><img src="{{crypto.urlImmagine}}" width="50px"></td>
                <td>{{crypto.simbolo}}</td>
                <td>{{crypto.nome}}</td>
                <td>
                    <p-button label="Modifica" severity="primary" [rounded]="true" icon="pi pi-pencil" (onClick)="showUpdateDialog(crypto)" />
                </td>
                <td>
                    <p-button label="Elimina" severity="danger" [rounded]="true" icon="pi pi-trash" (onClick)="deleteCrypto(crypto.simbolo)" />
                </td>
            </tr>
        </ng-template>
    </p-table>
</p-card>